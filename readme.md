# AutoRestart

一个基于 [MCDR](https://mcdreforged.com/zh-CN) 实现的服务端插件，实现了服务器关停后自动重启的功能，以此来应对服务器在某些异常情况下意外退出的情况

## 实现原理

MCJE服务器在退出时会返回状态码，通常情况下状态码为`0`意味着服务器正常退出，因此我们可以将一些服务器退出状态码加入白名单当中，如果服务器以白名单当中的状态码退出，那么不执行重启操作

例如可以将退出状态码`0`加入白名单，这份白名单由插件运行后创建的配置文件维护，位于`config/auto_restart/config.yml`，可以通过配置`avoid_restart_on_exit_code`这一项来从返回码白名单中删除或添加某个返回码

## 使用方法

AutoRestart插件需要python版本高于`3.12.4`，将插件文件直接加入`plugins`目录下即可运行，在`服务器`或`控制台`中可通过键入命令

```
!!autorestart
```

来查看当前插件状态，包括插件是否开启以及退出码白名单信息

更改插件配置文件，需要进入`config/auto_restart/`目录下，编辑`config.yml`配置文件，并在配置完成之后，键入

```
!!MCDR plugin reload auto_restart
```

来重载插件，若插件为启用状态，那么会在服务器退出时监听服务器退出码，并在退出码不在白名单时尝试执行重启服务器的操作

